# バックエンド実装ガイド

このガイドは、音楽アプリのバックエンドAPIを実装するのに役立ちます。テストの作成やプロセス全体でのAI支援の活用方法も含まれています。

## ステップ1：要件と既存のAPIルートを理解する

1. `docs/requirements.md`ファイルを確認し、必要な機能を理解します。
2. `src/routes/api/`にあるスケルトンAPIルートを調べます：
   - artist/+server.ts
   - song/+server.ts

## ステップ2：APIエンドポイントを計画する

1. LLMを使用してAPIエンドポイントの設計を支援してもらいます。例：
   プロンプト：「アーティストと曲を扱う音楽アプリで、どのようなRESTful APIエンドポイントを作成すべきですか？CRUD操作と音楽ストリーミングサービスに必要な追加機能を考慮してください。」
2. LLMの提案と既存のスケルトンルートを比較し、追加で作成が必要なエンドポイントを特定します。

## ステップ3：APIエンドポイントを実装する

各エンドポイントについて：
1. `src/routes/api/`にある既存のスケルトンから始めるか、必要に応じて新しいファイルを作成します。
2. AIを使用してエンドポイントのロジックの実装を支援してもらいます。例：
   プロンプト：「このSvelteKit APIルートで、アーティストを取得するGETロジックをどのように実装できますか？ページネーションとPrismaを使用した効率的なデータベースクエリを考慮してください。」
   [GETハンドラのスケルトンコードを貼り付ける]
3. AIを使用してデータベースクエリの作成を支援してもらいます。例：
   プロンプト：「アーティストと曲に関するこのPrismaスキーマを使用して、すべてのアーティストと関連する曲を効率的にクエリするにはどうすればよいですか？」
   [Prismaスキーマを貼り付ける]
4. AI生成のコードを批判的に確認し、調整して、プロジェクトの要件とベストプラクティスに合致していることを確認します。

## ステップ4：エラー処理とバリデーション

1. AIを使用してエンドポイントのエラー処理戦略を提案してもらいます。例：
   プロンプト：「SvelteKit APIルートでのエラー処理のベストプラクティスは何ですか？一貫性のあるエラーレスポンスをどのように実装できますか？」
2. エンドポイントの入力バリデーションを実装します。LLMに提案を求めます：
   プロンプト：「SvelteKit APIルートで新しいアーティストを作成する際の入力バリデーションをどのように実装できますか？適切な場合はバリデーションライブラリの使用を検討してください。」
3. 提案されたエラー処理とバリデーション戦略を実装し、特定のニーズに合わせて調整します。

## ステップ5：テストを作成する

各エンドポイントについて：
1. テストファイルを作成します（例：`src/routes/api/artist.test.ts`）。
2. AIを使用してテストケースの生成を支援してもらいます。例：
   プロンプト：「音楽アプリのアーティストAPIのGETとPOSTエンドポイントについて、どのようなテストケースを考慮すべきですか？正常系と異常系の両方を含めてください。」
3. テストを実装し、AIを使用してテストフレームワークとアサーションの支援を受けます。
4. テストを実行し、AIを使用して失敗の解釈と修正を支援してもらいます。

## ステップ6：最適化とセキュリティ

1. LLMにAPIのパフォーマンス最適化の可能性について尋ねます。例：
   プロンプト：「音楽ストリーミングアプリのSvelteKit APIルートのパフォーマンスをどのように最適化できますか？データベースクエリの最適化とキャッシング戦略を考慮してください。」
2. 提案された最適化を実装し、その影響をテストします。
3. AIを使用してAPIのセキュリティベストプラクティスをレビューします：
   プロンプト：「音楽アプリのAPIについて、どのようなセキュリティ上の考慮事項を念頭に置くべきですか？これらをSvelteKitでどのように実装できますか？」

## ステップ7：ドキュメンテーション

1. AIを使用してAPIドキュメントの生成を支援してもらいます。例：
   プロンプト：「音楽アプリのAPIエンドポイントについて、明確で包括的なドキュメントをどのように作成できますか？構造と含めるべき主要な要素を提案してください。」
2. ドキュメントを実装します。コード内のコメントとして、または別のマークダウンファイルとして実装します。

AI生成の提案をすべて批判的に評価し、頻繁にテストを実行し、テスト結果とプロジェクトの要件に基づいて実装を調整することを忘れないでください。不明な概念や実装について、LLMに説明や明確化を求めることをためらわないでください。
